define("gallery/lazyLoad/1.0.0/lazyLoad",["$"],function(a,b,c){function d(a,b){var c=this;return c instanceof d?(c.container=void 0===a?[e(document)]:e.isArray(a)?a:[a],c.config=e.extend(h,b),c._init(),void 0):new Lazyload(containers,b)}var e=a("$"),f="scroll",g="resize";!function(a,b){var c,d=a.jQuery||a.Cowboy||(a.Cowboy={});d.throttle=c=function(a,c,e,f){function g(){function d(){i=+new Date,e.apply(j,l)}function g(){h=b}var j=this,k=+new Date-i,l=arguments;f&&!h&&d(),h&&clearTimeout(h),f===b&&k>a?d():c!==!0&&(h=setTimeout(f?g:d,f===b?a-k:a))}var h,i=0;return"boolean"!=typeof c&&(f=e,e=c,c=b),d.guid&&(g.guid=e.guid=e.guid||d.guid++),g},d.debounce=function(a,d,e){return e===b?c(a,d,!1):c(a,e,d!==!1)}}(this);var h={lazyAttr:"data-ks-lazyload",lazyCls:"cls-ks-lazyload",threshold:100,delay:400,scrollX:!1,scrollY:!0,callback:[]};d.prototype={_init:function(){var a=this;a.callback=a.config.callback,a.updateLazyElement(),a._resizeFn(),a._scrollLoad=e.throttle(a.config.delay,e.proxy(a._scrollFn,a)),a._resizeLoad=e.throttle(a.config.delay,e.proxy(a._resizeFn,a)),a._start()},updateLazyElement:function(){for(var a=this,b=a.container,c=[],d=[],e=0,f=b.length;f>e;e++){var g=b[e];c=c.concat(a._getLazyImg(g)),d=d.concat(a._getLazyArea(g))}a.img=c,a.area=d},_getLazyImg:function(a){var b=this,c=e(a).find("img["+b.config.lazyAttr+"]");return e.makeArray(c)},_getLazyArea:function(a){var b=this,c=e(a).find("textarea."+b.config.lazyCls);return e.makeArray(c)},_resizeFn:function(){var a=this;a.viewportWidth=e(window).width(),a.viewportHeight=e(window).height(),a._scrollFn()},_scrollFn:function(){var a=this;a._loadLazyElement(),a._getLazyEleLength()<1&&a._stop()},_loadLazyElement:function(){var a=this;a._loadLazyImg(),a._loadLazyArea(),a._loadLazyCallback()},_start:function(){var a=this,b=e(window);b.on(f,a._scrollLoad),b.on(g,a._resizeLoad)},_stop:function(){var a=this,b=e(window);b.detach(f,a._scrollLoad),b.detach(g,a._resizeLoad)},_getLazyEleLength:function(){var a=this;return a.img.length+a.area.length+a.callback.length},_loadLazyImg:function(){var a=this;a.img=e.grep(a.img,e.proxy(a._filterImg,a))},_filterImg:function(a){var b=this;return b._inViewport(a)?(b._renderLazyImg(a),void 0):!0},_renderLazyImg:function(a){var b=this,c=e(a),d=b.config.lazyAttr,f=c.attr(d);f&&(c.attr("src",f),c.removeAttr(d))},_loadLazyArea:function(){var a=this;a.area=e.grep(a.area,e.proxy(a._filterArea,a))},_filterArea:function(a){var b=this;return b._inViewport(a)?(b._renderLazyArea(a),void 0):!0},_renderLazyArea:function(a){var b=this,c=e(a),d=b.config.lazyCls;if(c.hasClass(d)){c.parent().hasClass("cls-ks-loading")&&c.parent().removeClass("cls-ks-loading");var f=e("<div>");f.html(c.val(),!0).insertBefore(c),c.removeClass(d).hide()}},_loadLazyCallback:function(){var a=this;a.callback=e.grep(a.callback,e.proxy(a._filterCallback,a))},_filterCallback:function(a){var b=this;return e(a.ele).length<1?!1:b._inViewport(a.ele)?(b._fireCallback(a),void 0):!0},_fireCallback:function(a){var b=a.ele,c=a.fn;S.isFunction(c)&&c.call(b)},_inViewport:function(a){var b=this,c=e(a),d=c.offset(),f=b.config.threshold,g=!1,h=!1;if("none"==c.css("display")||c.width()<=0)return!1;if(b.config.scrollY){var i=e(document).scrollTop();g=b.viewportHeight+i<d.top-f}if(b.config.scrollX){var j=e(document).scrollLeft();h=b.viewportWidth+j<d.left-f}return!(g||h)}},c.exports=d});
